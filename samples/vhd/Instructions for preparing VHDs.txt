1. Download Convert-WindowsImage.ps1 from TechNet ScriptCenter

2. Download Windows ISO's from MSDN or the VL website

3. Use Convert-WindowsImage.ps1 to create VHD's. Examples:

. .\Convert-WindowsImage.ps1
Convert-WindowsImage -SourcePath "$pwd\en_windows_server_2016_x64_dvd_9327751.iso" -Edition ServerDataCenter -VHDFormat VHD -VhdPartitionStyle MBR -VHDPath .\14393.server.datacenter.vhd -SizeBytes 200GB -Feature NetFx3
Convert-WindowsImage -SourcePath "$pwd\en_windows_server_2016_x64_dvd_9327751.iso" -Edition ServerDataCenter -VHDFormat VHDX -VhdPartitionStyle GPT -VHDPath .\14393.server.datacenter.vhdx -SizeBytes 200GB -Feature NetFx3
Convert-WindowsImage -SourcePath "$pwd\en_windows_10_multi-edition_version_1709_updated_nov_2017_x64_dvd_100290211.iso" -Edition Professional -VHDFormat VHDX -VhdPartitionStyle GPT -VHDPath .\14393.client.professional.vhdx -SizeBytes 200GB -Feature NetFx3

For Gen1 VM's: -VHDFormat VHD -VhdPartitionStyle MBR
For Gen2 VM's: -VHDFormat VHDX -VhdPartitionStyle GPT
